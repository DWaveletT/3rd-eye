---
create_time: 1688220477
update_time: 1688220477
title: 关于数据范围分隔的分析
board: 1
tag:
- 2
---

## 需求

现在需要写一个脚本，可以自动按照规范将大多数数据范围正确地分隔开来。

例如，

- $1\le n\le 10^5,1\le m\le 10^5$ 应当被正确写作 $1\le n\le 10^5$，$1\le m\le 10^5$；
- $l\le a_i\le r,1\le l\le r \le n$ 应当被正确写作 $l\le a_i\le r$，$1\le l\le r \le n$；
- $1\le a,b,c\le 10^5,1\le n\le 1,000,000$ 应当被正确写作 $1\le a,b,c\le 10^5$，$1\le n\le 10^5$。

## 分析

首先我们要分析一个正确的数据范围的分隔，应该是什么模样。

容易发现，错误的分隔想要改为正确的分隔，需要将错误放置的逗号提出到公式外侧。因此去考虑逗号在数据范围里的应用。

- 在错误的数据范围里，逗号被用来分隔不同的范围，例如 $1\le n\le 10,1\le m\le 100$；
- 我们会使用形如 $1,000,000$ 的写法分隔数字，尽管更正确的写法是 $1{,}000{,}000$；
- 我们会使用形如 $1\le a,b,c\le n$ 的写法来简化多个变量的数据范围。

需要注意到的是，这三种情况还有可能会发生混用，例如，

- $1\le a,b\le 1,000,000,1\le n\le 10,1\le l,r\le 100$。

为了方便处理，我希望能够辨识出情形 $2$，也就是逗号被用于分隔的情况。通常是以 $3$ 个数字为一组进行分隔（虽然也可能出现 $4$ 个，但是不常见）。大多数分隔还是以 $000$ 为主，但也可能出现特例，如 $1,000,000,007$（包括其他 $0$ 比较多的大质数），$998,244,353$（包括修改了其中一两个数字的变体）。由于数据范围里通常不会出现形如 $1\le n\le  123,456,789 \le m \le 10^9$ 的奇怪范围，因此大可将连续 $3$ 或者 $4$ 个数字连在一起出现的数字串看作一个分隔。

实践上，我们找出所有形如 $\verb!X,YYY!$ 和 $\verb!X,YYYY!$ 的数字串，并将 $\verb!Y!$ 与 $\verb!X!$ 看作一体。这应当足以应对绝大多数情况。

在消除了逗号作为分隔的情形后，我们去考虑如下几个例子：

- $1\le x,y,1\le n\le 10^5$ 应当为 $1\le x,y$，$1\le n\le 10^5$（尽管规范要求每个数字都要有上界，但是不可避免出现这样没有上界的数据范围）；
- $1\le x,y\le n$；
- $1\le n\le 10^5,1\le m\le 10^6$；
- $l\le n\le r,x\le m\le y$；
- $1\le a\le b\le c\le n$。
